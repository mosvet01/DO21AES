
&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	ТипИсточника = ТипЗнч(Параметры.ИсточникСсылка);
	
	Отправка = Неопределено;
	
	Если ТипИсточника = Тип("СправочникСсылка.ОтправкиБанкРоссии") Тогда
		Отправка = Параметры.ИсточникСсылка;	
	Иначе //РегламентированныйОтчет или ЭлектронноеПредставление
		Отправка = ДокументооборотСБанкомРоссии.ПолучитьПоследнююОтправкуОтчета(Параметры.ИсточникСсылка);
	КонецЕсли;
	
	Если ЗначениеЗаполнено(Отправка) Тогда
		Протокол = Отправка.Протокол.Получить();
		ИмяФайлаПротокола = ПолучитьИмяВременногоФайла("html");
		Протокол.Записать(ИмяФайлаПротокола);
		Текст = Новый ЧтениеТекста(ИмяФайлаПротокола, "utf-8");
		HTMLТекст = Текст.Прочитать();
		Текст.Закрыть();
		УдалитьФайлы(ИмяФайлаПротокола);
	КонецЕсли;
	
	Если Отправка.СтатусОтправки = Перечисления.СтатусыОтправки.Сдан Тогда
		Заголовок = НСтр("ru = 'Протокол о сдаче'");
	Иначе
		Заголовок = НСтр("ru = 'Протокол ошибок'");
	КонецЕсли;
	
	Элементы.КнопкаПечать.Видимость = Параметры.Свойство("ПечатьВозможна") И Параметры.ПечатьВозможна = Истина;
	
КонецПроцедуры

&НаКлиенте
Процедура Печать(Команда)
	
	Элементы.HTMLТекст.Документ.execCommand("Print");
	
КонецПроцедуры
