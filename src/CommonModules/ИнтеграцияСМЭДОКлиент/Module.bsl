// @strict-types

#Область СлужебныйПрограммныйИнтерфейс

// Открыть выбор контактного лица - зависит от конфигурации.
// 
// Параметры:
//  Контрагент - ОпределяемыйТип.КонтрагентМЭДО - Контрагент
//  КЛ - ОпределяемыйТип.КонтактноеЛицоМЭДО
//  Элемент - ПолеФормы - Элемент формы - владелец, из которого идет открытие формы.
//  ИмяЭлемента - Строка - Имя этого элемента для вывода сообщения об ошибке
Процедура ОткрытьВыборКонтактногоЛица(Контрагент, КЛ, Элемент, ИмяЭлемента = "") Экспорт
	
	Если Не ЗначениеЗаполнено(Контрагент) Тогда 
		Если Не ЗначениеЗаполнено(ИмяЭлемента) Тогда
			ИмяЭлемента = НСтр("ru = 'Юрлицо исполнителя'");
		КонецЕсли;
		ОчиститьСообщения();
		ОбщегоНазначенияКлиент.СообщитьПользователю(СтрШаблон(
			НСтр("ru = 'Не заполнено поле ""%1""'"), ИмяЭлемента));
	Иначе
		Отбор = Новый Структура;
		Отбор.Вставить("Владелец", Контрагент);
		Отбор.Вставить("ПометкаУдаления", Ложь);
		
		ПараметрыФормы = Новый Структура;
		ПараметрыФормы.Вставить("Отбор", Отбор);
		ПараметрыФормы.Вставить("ТекущаяСтрока", КЛ);
		
		ОткрытьФорму("Справочник.КонтактныеЛица.ФормаВыбора", ПараметрыФормы, Элемент,,,,,
			РежимОткрытияОкнаФормы.БлокироватьОкноВладельца);
	КонецЕсли;
	
КонецПроцедуры

#КонецОбласти
